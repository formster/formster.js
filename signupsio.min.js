!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Signupsio=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var indexOf=typeof Array.prototype.indexOf==="function"?function(arr,el){return arr.indexOf(el)}:function(arr,el){for(var i=0;i<arr.length;i++){if(arr[i]===el)return i}return-1};var isArray=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"};var objectKeys=Object.keys||function(obj){var ret=[];for(var key in obj){if(obj.hasOwnProperty(key)){ret.push(key)}}return ret};var forEach=typeof Array.prototype.forEach==="function"?function(arr,fn){return arr.forEach(fn)}:function(arr,fn){for(var i=0;i<arr.length;i++)fn(arr[i])};var reduce=function(arr,fn,initial){if(typeof arr.reduce==="function")return arr.reduce(fn,initial);var res=initial;for(var i=0;i<arr.length;i++)res=fn(res,arr[i]);return res};var isint=/^[0-9]+$/;function promote(parent,key){if(parent[key].length==0)return parent[key]={};var t={};for(var i in parent[key]){if(hasOwnProperty.call(parent[key],i)){t[i]=parent[key][i]}}parent[key]=t;return t}function parse(parts,parent,key,val){var part=parts.shift();if(Object.getOwnPropertyDescriptor(Object.prototype,key))return;if(!part){if(isArray(parent[key])){parent[key].push(val)}else if("object"==typeof parent[key]){parent[key]=val}else if("undefined"==typeof parent[key]){parent[key]=val}else{parent[key]=[parent[key],val]}}else{var obj=parent[key]=parent[key]||[];if("]"==part){if(isArray(obj)){if(""!=val)obj.push(val)}else if("object"==typeof obj){obj[objectKeys(obj).length]=val}else{obj=parent[key]=[parent[key],val]}}else if(~indexOf(part,"]")){part=part.substr(0,part.length-1);if(!isint.test(part)&&isArray(obj))obj=promote(parent,key);parse(parts,obj,part,val)}else{if(!isint.test(part)&&isArray(obj))obj=promote(parent,key);parse(parts,obj,part,val)}}}function merge(parent,key,val){if(~indexOf(key,"]")){var parts=key.split("["),len=parts.length,last=len-1;parse(parts,parent,"base",val)}else{if(!isint.test(key)&&isArray(parent.base)){var t={};for(var k in parent.base)t[k]=parent.base[k];parent.base=t}set(parent.base,key,val)}return parent}function compact(obj){if("object"!=typeof obj)return obj;if(isArray(obj)){var ret=[];for(var i in obj){if(hasOwnProperty.call(obj,i)){ret.push(obj[i])}}return ret}for(var key in obj){obj[key]=compact(obj[key])}return obj}function parseObject(obj){var ret={base:{}};forEach(objectKeys(obj),function(name){merge(ret,name,obj[name])});return compact(ret.base)}function parseString(str){var ret=reduce(String(str).split("&"),function(ret,pair){var eql=indexOf(pair,"="),brace=lastBraceInKey(pair),key=pair.substr(0,brace||eql),val=pair.substr(brace||eql,pair.length),val=val.substr(indexOf(val,"=")+1,val.length);if(""==key)key=pair,val="";if(""==key)return ret;return merge(ret,decode(key),decode(val))},{base:{}}).base;return compact(ret)}exports.parse=function(str){if(null==str||""==str)return{};return"object"==typeof str?parseObject(str):parseString(str)};var stringify=exports.stringify=function(obj,prefix){if(isArray(obj)){return stringifyArray(obj,prefix)}else if("[object Object]"==toString.call(obj)){return stringifyObject(obj,prefix)}else if("string"==typeof obj){return stringifyString(obj,prefix)}else{return prefix+"="+encodeURIComponent(String(obj))}};function stringifyString(str,prefix){if(!prefix)throw new TypeError("stringify expects an object");return prefix+"="+encodeURIComponent(str)}function stringifyArray(arr,prefix){var ret=[];if(!prefix)throw new TypeError("stringify expects an object");for(var i=0;i<arr.length;i++){ret.push(stringify(arr[i],prefix+"["+i+"]"))}return ret.join("&")}function stringifyObject(obj,prefix){var ret=[],keys=objectKeys(obj),key;for(var i=0,len=keys.length;i<len;++i){key=keys[i];if(""==key)continue;if(null==obj[key]){ret.push(encodeURIComponent(key)+"=")}else{ret.push(stringify(obj[key],prefix?prefix+"["+encodeURIComponent(key)+"]":encodeURIComponent(key)))}}return ret.join("&")}function set(obj,key,val){var v=obj[key];if(Object.getOwnPropertyDescriptor(Object.prototype,key))return;if(undefined===v){obj[key]=val}else if(isArray(v)){v.push(val)}else{obj[key]=[v,val]}}function lastBraceInKey(str){var len=str.length,brace,c;for(var i=0;i<len;++i){c=str[i];if("]"==c)brace=false;if("["==c)brace=true;if("="==c&&!brace)return i}}function decode(str){try{return decodeURIComponent(str.replace(/\+/g," "))}catch(err){return str}}},{}],2:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/randomstring")},{"./lib/randomstring":3}],3:[function(_dereq_,module,exports){var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz";exports.generate=function(length){length=length?length:32;var string="";for(var i=0;i<length;i++){var randomNumber=Math.floor(Math.random()*chars.length);string+=chars.substring(randomNumber,randomNumber+1)}return string}},{}],4:[function(_dereq_,module,exports){var cookies=_dereq_("./cookies");var randomstring=_dereq_("randomstring");var Keen=_dereq_("./lib/keen_track");module.exports=Api;function Api(key){this.key=key||"";if(key)this._setKeys(key);if(!cookies.hasItem("signups.io")){this.cookie=randomstring.generate();cookies.setItem("signups.io",this.cookie,Infinity,"/")}else{this.cookie=cookies.getItem("signups.io")}}Api.Keen=Keen;Api.prototype._setKeys=function(key){var parts=key.split(":");this._projectId=parts[0];this._writeKey=parts[1];this._userId=parts[2];this._siteId=parts[3];this._public=!!parts[4]};Api.prototype.register=function(key){this.key=key;if(this.key)this._setKeys(this.key)};Api.prototype.sendEvent=function(name,data,callback){if(!this.key){throw new Error("No site registered.")}callback=callback||function(){};data=data||{};if(data.meta)throw new Error("Meta data is reserved for Signups.io");data.meta={"public":!!this._public,user:this._userId,site:this._siteId,ip_address:"${keen.ip}",user_agent:"${keen.user_agent}",protocol:document.location.protocol,url:document.location.pathname,host:document.location.hostname,cookie:this.cookie};if(name[0]==="$")name="_"+name;name=name.replace(/\./gi,"_");if(name.length>256){name=name.slice(0,256)}Api.Keen.configure({projectId:this._projectId,writeKey:this._writeKey});Api.Keen.addEvent(name,data,function(success){callback(null,success)},function(err){callback(err)})}},{"./cookies":5,"./lib/keen_track":7,randomstring:2}],5:[function(_dereq_,module,exports){module.exports={getItem:function(sKey){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(sKey,sValue,vEnd,sPath,sDomain,bSecure){if(!sKey||/^(?:expires|max\-age|path|domain|secure)$/i.test(sKey)){return false}var sExpires="";if(vEnd){switch(vEnd.constructor){case Number:sExpires=vEnd===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+vEnd;break;case String:sExpires="; expires="+vEnd;break;case Date:sExpires="; expires="+vEnd.toUTCString();break}}document.cookie=encodeURIComponent(sKey)+"="+encodeURIComponent(sValue)+sExpires+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"")+(bSecure?"; secure":"");return true},removeItem:function(sKey,sPath,sDomain){if(!sKey||!this.hasItem(sKey)){return false}document.cookie=encodeURIComponent(sKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"");return true},hasItem:function(sKey){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){var aKeys=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var nIdx=0;nIdx<aKeys.length;nIdx++){aKeys[nIdx]=decodeURIComponent(aKeys[nIdx])}return aKeys}}},{}],6:[function(_dereq_,module,exports){exports.each=each;exports.addClass=addClass;exports.removeClass=removeClass;exports.ready=ready;exports.val=val;exports.trigger=trigger;function each(el,selector,fn){if(arguments.length<3){fn=selector;selector=el;el=document}Array.prototype.forEach.call(el.querySelectorAll(selector),fn)}function addClass(el,className){if(el.classList){el.classList.add(className)}else if(!~el.className.split(" ").indexOf(className)){el.className+=" "+className}}function removeClass(el,className){el.className=el.className.replace(new RegExp("(^|\\b)"+className.split(" ").join("|")+"(\\b|$)","gi")," ")}function ready(fn){document.addEventListener("DOMContentLoaded",fn)}function val(el,values){if(!el.getAttribute("name"))return values;if("input"===el.tagName){if("radio"===el.getAttribute("type")){values[el.getAttribute("name")]=el.value}if("checkbox"===el.getAttribute("type")){values[el.getAttribute("name")]=values[el.getAttribute("name")]||[];values[el.getAttribute("name")].push(el.value)}}values[el.getAttribute("name")]=el.value;return values}function trigger(el,evt,data){var event;if(window.CustomEvent){event=new CustomEvent(evt,{detail:data})}else{event=document.createEvent("CustomEvent");event.initCustomEvent(evt,true,true,data)}el.dispatchEvent(event)}},{}],7:[function(_dereq_,module,exports){var Keen=exports;var alertFallback=false;if(typeof console==="undefined"||typeof console.log==="undefined"){console={};if(alertFallback){console.log=function(msg){alert(msg)}}else{console.log=function(){}}}var Base=function(){};Base.extend=function(_instance,_static){var extend=Base.prototype.extend;Base._prototyping=true;var proto=new this;extend.call(proto,_instance);proto.base=function(){};delete Base._prototyping;var constructor=proto.constructor;var klass=proto.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==klass){this._constructing=true;constructor.apply(this,arguments);delete this._constructing}else if(arguments[0]!=null){return(arguments[0].extend||extend).call(arguments[0],proto)}}};klass.ancestor=this;klass.extend=this.extend;klass.forEach=this.forEach;klass.implement=this.implement;klass.prototype=proto;klass.toString=this.toString;klass.valueOf=function(type){return type=="object"?klass:constructor.valueOf()};extend.call(klass,_static);if(typeof klass.init=="function")klass.init();return klass};Base.prototype={extend:function(source,value){if(arguments.length>1){var ancestor=this[source];if(ancestor&&typeof value=="function"&&(!ancestor.valueOf||ancestor.valueOf()!=value.valueOf())&&/\bbase\b/.test(value)){var method=value.valueOf();value=function(){var previous=this.base||Base.prototype.base;this.base=ancestor;var returnValue=method.apply(this,arguments);this.base=previous;return returnValue};value.valueOf=function(type){return type=="object"?value:method};value.toString=Base.toString}this[source]=value}else if(source){var extend=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){extend=this.extend||extend}var proto={toSource:null};var hidden=["constructor","toString","valueOf"];var i=Base._prototyping?0:1;while(key=hidden[i++]){if(source[key]!=proto[key]){extend.call(this,key,source[key])}}for(var key in source){if(!proto[key])extend.call(this,key,source[key])}}return this}};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(object,block,context){for(var key in object){if(this.prototype[key]===undefined){block.call(context,object[key],key,object)}}},implement:function(){for(var i=0;i<arguments.length;i++){if(typeof arguments[i]=="function"){arguments[i](this.prototype)}else{this.prototype.extend(arguments[i])}}return this},toString:function(){return String(this.valueOf())}});Keen.configure=function(config){this.client=new Keen.Client(config);return this.client};Keen.addEvent=function(eventCollection,event,success,error){if(this.client){this.client.uploadEvent(eventCollection,event,success,error)}};Keen.trackExternalLink=function(htmlElementOrEvent,eventCollection,event,timeout,timeoutCallback){var htmlElement=htmlElementOrEvent;var jsEvent=null;var newTab=false;if(!htmlElementOrEvent.nodeName){jsEvent=htmlElementOrEvent;htmlElement=jsEvent.target;newTab=htmlElementOrEvent.metaKey||false}else if(window.event&&window.event.metaKey==true){newTab=true}if(timeout===undefined){timeout=500}var triggered=false;var callback=function(){};if(htmlElement.nodeName==="A"){callback=function(){if(!newTab&&!triggered){triggered=true;window.location=htmlElement.href}}}else if(htmlElement.nodeName==="FORM"){callback=function(){if(!triggered){triggered=true;htmlElement.submit()}}}if(timeoutCallback){callback=function(){if(!triggered){triggered=true;timeoutCallback()}}}Keen.addEvent(eventCollection,event,callback,callback);setTimeout(function(){callback()},timeout);if(!newTab){return false}};Keen.getEventCollections=function(success,error){var url=this.client.getKeenUrl("/events");this.client.getJSON(url,success,error)};Keen.getEventCollectionProperties=function(eventCollection,success,error){var url=this.client.getKeenUrl("/events/"+eventCollection);this.client.getJSON(url,success,error)};Keen.setGlobalProperties=function(newGlobalProperties){if(this.client){if(newGlobalProperties&&typeof newGlobalProperties=="function"){this.client.globalProperties=newGlobalProperties}else{throw new Error("Invalid value for global properties: "+newGlobalProperties)}}};Keen.Client=function(config){if(typeof config.projectId==="undefined"||!config.projectId){throw new Error("Configuration must include a valid projectId")}else{this.projectId=config.projectId}this.writeKey=config.writeKey;this.readKey=config.readKey;this.globalProperties=null;this.keenUrl="https://api.keen.io";if(config!==undefined&&config.keenUrl!==undefined){this.keenUrl=config.keenUrl}};Keen.Client.prototype.uploadEvent=function(eventCollection,event,success,error){var url=this.getKeenUrl("/events/"+eventCollection);var newEvent={};if(this.globalProperties){newEvent=this.globalProperties(eventCollection)}for(var property in event){if(event.hasOwnProperty(property)){newEvent[property]=event[property]}}if(supportsXhr()){sendXhr("POST",url,null,newEvent,this.writeKey,success,error)}else{var jsonBody=JSON.stringify(newEvent);var base64Body=Keen.Base64.encode(jsonBody);url=url+"?api_key="+this.writeKey;url=url+"&data="+base64Body;url=url+"&modified="+(new Date).getTime();sendJsonpRequest(url,null,success,error)}};Keen.Client.prototype.getKeenUrl=function(path){return this.keenUrl+"/3.0/projects/"+this.projectId+path};function supportsXhr(){if(typeof XMLHttpRequest==="undefined"){return false}else{return"withCredentials"in new XMLHttpRequest}}function sendXhr(method,url,headers,body,apiKey,success,error){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300){var response;try{response=JSON.parse(xhr.responseText)}catch(e){console.log("Could not JSON parse HTTP response: "+xhr.responseText);if(error){error(xhr,e)}}if(response){if(success){success(response)}}}else{console.log("HTTP request failed.");if(error){error(xhr,null)}}}};xhr.open(method,url,true);if(apiKey){xhr.setRequestHeader("Authorization",apiKey)}if(body){xhr.setRequestHeader("Content-Type","application/json")}if(headers){for(var headerName in headers){if(headers.hasOwnProperty(headerName)){xhr.setRequestHeader(headerName,headers[headerName])}}}var toSend=body?JSON.stringify(body):null;xhr.send(toSend)}function sendJsonpRequest(url,apiKey,success,error){if(apiKey&&url.indexOf("api_key")<0){var delimiterChar=url.indexOf("?")>0?"&":"?";url=url+delimiterChar+"api_key="+apiKey}var callbackName="keenJSONPCallback"+(new Date).getTime();while(callbackName in window){callbackName+="a"}var loaded=false;window[callbackName]=function(response){loaded=true;if(success&&response){success(response)}window[callbackName]=undefined};url=url+"&jsonp="+callbackName;var script=document.createElement("script");script.id="keen-jsonp";script.src=url;document.getElementsByTagName("head")[0].appendChild(script);script.onreadystatechange=function(){if(loaded===false&&this.readyState==="loaded"){loaded=true;if(error){error()}}};script.onerror=function(){if(loaded===false){loaded=true;if(error){error()}}}}Keen.Client.prototype.getJSON=function(url,success,error){if(supportsXhr()){sendXhr("GET",url,null,null,this.readKey,success,error)}else{sendJsonpRequest(url,this.readKey,success,error)}};Keen.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Keen.Base64._utf8_encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=(chr1&3)<<4|chr2>>4;enc3=(chr2&15)<<2|chr3>>6;enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else if(isNaN(chr3)){enc4=64}output=output+Keen.Base64._keyStr.charAt(enc1)+Keen.Base64._keyStr.charAt(enc2)+Keen.Base64._keyStr.charAt(enc3)+Keen.Base64._keyStr.charAt(enc4)}return output},decode:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=Keen.Base64._keyStr.indexOf(input.charAt(i++));enc2=Keen.Base64._keyStr.indexOf(input.charAt(i++));enc3=Keen.Base64._keyStr.indexOf(input.charAt(i++));enc4=Keen.Base64._keyStr.indexOf(input.charAt(i++));chr1=enc1<<2|enc2>>4;chr2=(enc2&15)<<4|enc3>>2;chr3=(enc3&3)<<6|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2)}if(enc4!=64){output=output+String.fromCharCode(chr3)}}output=Keen.Base64._utf8_decode(output);return output},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if(c>127&&c<2048){utftext+=String.fromCharCode(c>>6|192);utftext+=String.fromCharCode(c&63|128)}else{utftext+=String.fromCharCode(c>>12|224);utftext+=String.fromCharCode(c>>6&63|128);utftext+=String.fromCharCode(c&63|128)}}return utftext},_utf8_decode:function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++}else if(c>191&&c<224){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode((c&31)<<6|c2&63);i+=2}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode((c&15)<<12|(c2&63)<<6|c3&63);i+=3}}return string}};if(Keen._cf){Keen.configure(Keen._cf);Keen._cf=null}if(Keen._gp){Keen.setGlobalProperties(Keen._gp);Keen._gp=null}if(Keen._eq&&Keen._eq.length>0){for(var i=0;i<Keen._eq.length;i++){var eventCollection=Keen._eq[i].shift();var event=Keen._eq[i].shift();var success=Keen._eq[i].shift();var error=Keen._eq[i].shift();Keen.addEvent(eventCollection,event,success,error)}Keen._eq=null}if(Keen._ocrq&&Keen._ocrq.length>0){for(var i=0;i<Keen._ocrq.length;i++){var onChartsReadyHandler=Keen._ocrq[i];Keen.onChartsReady(onChartsReadyHandler)}Keen._ocrq=null}},{}],8:[function(_dereq_,module,exports){var Api=_dereq_("./api"),qs=_dereq_("qs"),dom=_dereq_("./dom");module.exports=Signupsio;function Signupsio(key){if(!(this instanceof Signupsio))return new Signupsio(key);this.api=new Signupsio.Api(key)}Signupsio.Api=Api;Signupsio.auto=function(){dom.ready(function(){dom.each("form.signupsio",function(form){var href=form.getAttribute("href");if(~href.indexOf("?")){var key=qs.parse(href.slice(href.indexOf("?")+1)).key;var signupsio=new Signupsio(key);signupsio.visit(document.title);signupsio.trackForm(form)}})})};Signupsio.prototype.trackForm=function(form){var self=this;form.addEventListener("submit",this._onSubmit(form));dom.each(form,"input, select, textarea, button",function(el){el.addEventListener("click",self._onClick(el))})};Signupsio.prototype.visit=function(page){this.api.sendEvent("visit",{page_name:page})};Signupsio.prototype._onClick=function(){var self=this;return function(e){self.api.sendEvent("click",{input_name:this.getAttribute("name"),input_type:this.tagName.toLowerCase()==="input"?this.getAttribute("type"):this.tagName.toLowerCase()})}};Signupsio.prototype._onSubmit=function(form){var self=this;return function(e){e.preventDefault();dom.addClass(form,"signupsio-submitting");var values={};dom.each(form,"input, select, textarea, button",function(el){dom.val(el,values)});self.api.sendEvent("signup",values,function(err,signup){dom.removeClass(form,"signupsio-submitting");if(err){dom.trigger(form,"signup:error",err);dom.addClass(form,"signupsio-error")}else{dom.trigger(form,"signup",values);dom.addClass(form,"signupsio-submitted")}})}};Signupsio.auto()},{"./api":4,"./dom":6,qs:1}]},{},[8])(8)});